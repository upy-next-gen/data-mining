2025-09-10 11:08:04,692 - INFO - Logging initialized. Log file: C:\Users\josea\Documents\data-mining\proyecto\logs\fase1_mapeo_20250910_110804.log
2025-09-10 11:08:04,693 - INFO - --- Fase 1: Mapeo y Descubrimiento (v5) ---
2025-09-10 11:08:04,693 - INFO - Starting recursive scan of directory: C:\Users\josea\Documents\data-mining\proyecto\data
2025-09-10 11:08:05,030 - INFO - Found 8413 total CSV files in the directory tree.
2025-09-10 11:08:05,099 - INFO - Processing 8208 files after excluding directories: __MACOSX, Datos abiertos
2025-09-10 11:08:05,099 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0625.csv
2025-09-10 11:08:05,159 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0325.csv
2025-09-10 11:08:05,175 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_1224.csv
2025-09-10 11:08:05,190 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0924.csv
2025-09-10 11:08:05,203 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0624.csv
2025-09-10 11:08:05,213 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0324.csv
2025-09-10 11:08:05,223 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_1223.csv
2025-09-10 11:08:05,233 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0923.csv
2025-09-10 11:08:05,249 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0623.csv
2025-09-10 11:08:05,264 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_03_2023.csv
2025-09-10 11:08:05,276 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_1222.csv
2025-09-10 11:08:05,286 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0922.csv
2025-09-10 11:08:05,300 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0622.csv
2025-09-10 11:08:05,310 - INFO - Found matching file in correct subfolder: conjunto_de_datos_ensu_cb_0322.csv
2025-09-10 11:08:05,320 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_12_2021.csv
2025-09-10 11:08:05,330 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_09_2021.csv
2025-09-10 11:08:05,342 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_06_2021.csv
2025-09-10 11:08:05,352 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_03_2021.csv
2025-09-10 11:08:05,364 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_12_2020.csv
2025-09-10 11:08:05,376 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_SEC4_ENSU_09_2020.csv
2025-09-10 11:08:05,387 - INFO - Used content fallback: Found period '0320' in column 'PER' for file conjunto_de_datos_CB_SEC4_ENSU_09_2020.csv
2025-09-10 11:08:05,398 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_SEC1_2_3_ENSU_09_2020.csv
2025-09-10 11:08:05,410 - INFO - Used content fallback: Found period '0320' in column 'PER' for file conjunto_de_datos_CB_SEC1_2_3_ENSU_09_2020.csv
2025-09-10 11:08:05,423 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_01_2020.csv
2025-09-10 11:08:05,433 - INFO - Found matching file in correct subfolder: conjunto_de_datos_CB_ENSU_04_2019.csv
2025-09-10 11:08:05,444 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ENSU_2019_2t.csv
2025-09-10 11:08:05,455 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_03_2019.csv
2025-09-10 11:08:05,464 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ENSU_04_2018.csv
2025-09-10 11:08:05,475 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_03_2018.csv
2025-09-10 11:08:05,486 - INFO - Found matching file in correct subfolder: ensu_cb_0218.csv
2025-09-10 11:08:05,497 - INFO - Found matching file in correct subfolder: ensu_cb_0118.csv
2025-09-10 11:08:05,507 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_04_2017.csv
2025-09-10 11:08:05,518 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_04_2016.csv
2025-09-10 11:08:05,528 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_04_2015.csv
2025-09-10 11:08:05,536 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_03_2017.csv
2025-09-10 11:08:05,547 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_03_2016.csv
2025-09-10 11:08:05,559 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_03_2015.csv
2025-09-10 11:08:05,567 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_02_2017.csv
2025-09-10 11:08:05,580 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_02_2016.csv
2025-09-10 11:08:05,593 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_02_2015.csv
2025-09-10 11:08:05,602 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_01_2017.csv
2025-09-10 11:08:05,614 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_01_2016.csv
2025-09-10 11:08:05,624 - INFO - Found matching file in correct subfolder: conjunto_de_datos_cb_ensu_01_2015.csv
2025-09-10 11:08:05,633 - INFO - Scan complete. Detected 41 matching CB files before de-duplication.
2025-09-10 11:08:05,636 - INFO - Starting de-duplication process...
2025-09-10 11:08:05,636 - INFO - Period '2020_Q1' had 3 files. Selected 'conjunto_de_datos_CB_SEC1_2_3_ENSU_09_2020.csv' as the primary.
2025-09-10 11:08:05,636 - INFO - Period '2019_Q2' had 2 files. Selected 'conjunto_de_datos_CB_ENSU_04_2019.csv' as the primary.
2025-09-10 11:08:05,636 - INFO - Period '2018_Q1' had 3 files. Selected 'conjunto_de_datos_cb_ensu_03_2018.csv' as the primary.
2025-09-10 11:08:05,637 - INFO - Period '2017_Q1' had 3 files. Selected 'conjunto_de_datos_cb_ensu_02_2017.csv' as the primary.
2025-09-10 11:08:05,637 - INFO - Period '2016_Q1' had 3 files. Selected 'conjunto_de_datos_cb_ensu_03_2016.csv' as the primary.
2025-09-10 11:08:05,637 - INFO - Period '2015_Q1' had 3 files. Selected 'conjunto_de_datos_cb_ensu_03_2015.csv' as the primary.
2025-09-10 11:08:05,637 - INFO - De-duplication complete. Final file count: 30
2025-09-10 11:08:05,637 - INFO - --- Resumen del Mapeo Final ---
2025-09-10 11:08:05,637 - INFO - Total de archivos CSV en el árbol: 8413
2025-09-10 11:08:05,637 - INFO - Total de archivos CB únicos procesados: 30
2025-09-10 11:08:05,637 - INFO - Con período identificado: 30
2025-09-10 11:08:05,637 - INFO - Sin período identificado: 0
2025-09-10 11:08:05,637 - INFO - --- Detalle por Período (únicos) ---
2025-09-10 11:08:05,637 - INFO - - 2015_Q1: 1 archivo(s)
2025-09-10 11:08:05,637 - INFO - - 2015_Q2: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2016_Q1: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2016_Q2: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2017_Q1: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2017_Q2: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2018_Q1: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2018_Q2: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2019_Q1: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2019_Q2: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2020_Q1: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2020_Q4: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2021_Q1: 1 archivo(s)
2025-09-10 11:08:05,638 - INFO - - 2021_Q2: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2021_Q3: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2021_Q4: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2022_Q1: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2022_Q2: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2022_Q3: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2022_Q4: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2023_Q1: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2023_Q2: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2023_Q3: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2023_Q4: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2024_Q1: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2024_Q2: 1 archivo(s)
2025-09-10 11:08:05,639 - INFO - - 2024_Q3: 1 archivo(s)
2025-09-10 11:08:05,640 - INFO - - 2024_Q4: 1 archivo(s)
2025-09-10 11:08:05,640 - INFO - - 2025_Q1: 1 archivo(s)
2025-09-10 11:08:05,640 - INFO - - 2025_Q2: 1 archivo(s)
2025-09-10 11:08:05,640 - INFO - Saving metadata mapping to C:\Users\josea\Documents\data-mining\proyecto\temp\mapeo_archivos.json
2025-09-10 11:08:05,642 - INFO - Successfully saved JSON output.
2025-09-10 11:08:05,643 - INFO - --- Fase 1 completada ---
