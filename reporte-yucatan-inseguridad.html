
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Percepción de Inseguridad (ENSU)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; margin: 0; background-color: #f8f9fa; color: #333; }
        .container { max-width: 900px; margin: 20px auto; padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        h1, h2 { color: #0056b3; border-bottom: 2px solid #dee2e6; padding-bottom: 10px; }
        .chart-container { margin-top: 30px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
        th { background-color: #f2f2f2; }
        .footer { margin-top: 30px; font-size: 0.8em; color: #666; text-align: center; }
        .note { background-color: #fff3cd; border-left: 5px solid #ffeeba; padding: 15px; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Reporte de Percepción de Inseguridad</h1>
        <p><strong>Fecha de generación:</strong> 10 de September de 2025</p>
        <div class="note">
            <strong>Acerca de los datos:</strong> Este reporte se basa en los datos de la Encuesta Nacional de Seguridad Pública Urbana (ENSU) del INEGI. Muestra la percepción de la población sobre la seguridad en su ciudad, no un conteo de delitos. Los datos presentados son un agregado de múltiples archivos y periodos.
        </div>

        <div class="chart-container">
            <h2>Evolución de la Percepción de Inseguridad (% de población que se siente insegura)</h2>
            <canvas id="evolucionChart"></canvas>
        </div>

        <div class="chart-container">
            <h2>Top 10 Municipios con Mayor Percepción de Inseguridad (Promedio Histórico)</h2>
            <canvas id="municipiosChart"></canvas>
        </div>

        <div class="chart-container">
            <h2>Resumen General</h2>
            <table>
                <tr><th>Métrica</th><th>Valor</th></tr>
                <tr><td>Total de Encuestas Analizadas</td><td>728210</td></tr>
                <tr><td>Promedio General de Percepción de Inseguridad</td><td>63.22%</td></tr>
            </table>
        </div>

        <div class="chart-container">
            <h2>Conclusiones Breves</h2>
            <ul>
                <li>La percepción de inseguridad ha mostrado fluctuaciones a lo largo del tiempo, con picos en periodos específicos que pueden correlacionar con eventos contextuales.</li>
                <li>Existe una notable diferencia en la percepción de inseguridad entre distintos municipios, indicando que la experiencia de seguridad es local.</li>
                <li>El análisis se centra en la percepción; esta puede no coincidir directamente con las tasas de criminalidad reales.</li>
                <li>Los datos agregados permiten observar tendencias generales, pero un análisis más profundo podría revelar patrones específicos por demografía o tipo de lugar.</li>
            </ul>
        </div>

        <div class="footer">
            <p>Reporte generado automáticamente. Datos fuente: INEGI (ENSU).</p>
        </div>
    </div>

    <script>
        const evolucionData = [{"periodo": "2015-T1", "pct_inseguridad_promedio": 68.54}, {"periodo": "2015-T2", "pct_inseguridad_promedio": 69.11}, {"periodo": "2015-T3", "pct_inseguridad_promedio": 67.5}, {"periodo": "2015-T4", "pct_inseguridad_promedio": 67.79}, {"periodo": "2016-T4", "pct_inseguridad_promedio": 71.47}, {"periodo": "2017-T1", "pct_inseguridad_promedio": 71.04}, {"periodo": "2017-T2", "pct_inseguridad_promedio": 71.6}, {"periodo": "2017-T3", "pct_inseguridad_promedio": 72.84}, {"periodo": "2017-T4", "pct_inseguridad_promedio": 73.47}, {"periodo": "2018-T1", "pct_inseguridad_promedio": 73.68}, {"periodo": "2018-T2", "pct_inseguridad_promedio": 71.52}, {"periodo": "2018-T3", "pct_inseguridad_promedio": 71.31}, {"periodo": "2018-T4", "pct_inseguridad_promedio": 69.49}, {"periodo": "2019-T1", "pct_inseguridad_promedio": 70.8}, {"periodo": "2019-T2", "pct_inseguridad_promedio": 69.21}, {"periodo": "2019-T3", "pct_inseguridad_promedio": 67.74}, {"periodo": "2019-T4", "pct_inseguridad_promedio": 69.4}, {"periodo": "2020-T1", "pct_inseguridad_promedio": 69.26}, {"periodo": "2020-T3", "pct_inseguridad_promedio": 63.79}, {"periodo": "2020-T4", "pct_inseguridad_promedio": 63.85}, {"periodo": "2021-T1", "pct_inseguridad_promedio": 61.76}, {"periodo": "2021-T2", "pct_inseguridad_promedio": 62.03}, {"periodo": "2021-T3", "pct_inseguridad_promedio": 61.62}, {"periodo": "2021-T4", "pct_inseguridad_promedio": 62.41}, {"periodo": "2022-T1", "pct_inseguridad_promedio": 62.59}, {"periodo": "2022-T2", "pct_inseguridad_promedio": 64.07}, {"periodo": "2022-T3", "pct_inseguridad_promedio": 60.77}, {"periodo": "2022-T4", "pct_inseguridad_promedio": 60.2}, {"periodo": "2023-T1", "pct_inseguridad_promedio": 58.98}, {"periodo": "2023-T2", "pct_inseguridad_promedio": 59.22}, {"periodo": "2023-T3", "pct_inseguridad_promedio": 58.91}, {"periodo": "2023-T4", "pct_inseguridad_promedio": 56.62}, {"periodo": "2024-T1", "pct_inseguridad_promedio": 57.83}, {"periodo": "2024-T2", "pct_inseguridad_promedio": 56.47}, {"periodo": "2024-T3", "pct_inseguridad_promedio": 56.26}, {"periodo": "2024-T4", "pct_inseguridad_promedio": 58.68}, {"periodo": "2025-T1", "pct_inseguridad_promedio": 59.27}, {"periodo": "2025-T2", "pct_inseguridad_promedio": 60.25}];
        const municipiosData = [{"municipio_code": 13.0, "pct_inseguros": 100.0}, {"municipio_code": 16.0, "pct_inseguros": 100.0}, {"municipio_code": 18.0, "pct_inseguros": 96.01}, {"municipio_code": 29.0, "pct_inseguros": 94.18}, {"municipio_code": 12.0, "pct_inseguros": 87.77}, {"municipio_code": 5.0, "pct_inseguros": 81.88}, {"municipio_code": 40.0, "pct_inseguros": 81.37}, {"municipio_code": 15.0, "pct_inseguros": 79.73}, {"municipio_code": 31.0, "pct_inseguros": 79.18}, {"municipio_code": 1.0, "pct_inseguros": 78.54}];

        if (evolucionData) {
            const ctxEvolucion = document.getElementById('evolucionChart').getContext('2d');
            new Chart(ctxEvolucion, {
                type: 'line',
                data: {
                    labels: evolucionData.map(d => d.periodo),
                    datasets: [{
                        label: '% de Percepción de Inseguridad',
                        data: evolucionData.map(d => d.pct_inseguridad_promedio),
                        borderColor: 'rgb(255, 99, 132)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: { scales: { y: { beginAtZero: true, ticks: { callback: value => value + '%' } } } }
            });
        }

        if (municipiosData) {
            const ctxMunicipios = document.getElementById('municipiosChart').getContext('2d');
            new Chart(ctxMunicipios, {
                type: 'bar',
                data: {
                    labels:municipiosData.map(d => 'Código: ' + d.municipio_code),
                    datasets: [{
                        label: 'Promedio Histórico de Percepción de Inseguridad (%)',
                        data:municipiosData.map(d => d.pct_inseguros),
                        backgroundColor: 'rgb(54, 162, 235)'
                    }]
                },
                options: { indexAxis: 'y', scales: { x: { beginAtZero: true, ticks: { callback: value => value + '%' } } } }
            });
        }
    </script>
</body>
</html>
